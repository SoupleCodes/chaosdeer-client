<!DOCTYPE html>
<html lang="en-UK">

<head>
    <title>chaosdeer</title>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="apple-touch-icon" type="image/png" href="/assets/icon256.png">
    <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="/assets/icon256.png">
    <meta rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="/icons.css" />
    <link rel="stylesheet" href="/global.css?92109" />
    <link id="top-style" rel="stylesheet" href="/themes/helium.css" />
    <style id="custom-style"></style>
</head>

<body>
    <div id="error-bar">
        <span onclick="closePopup();" class="text-clickable">Close</span> - <span id="error-text">Connecting...<span>
    </div>
    <div id="main">
        <div id="loading">
            <center>Taking too long to load? Try <span onclick="logOut();" class="text-clickable">a full reset</span>.
            </center>
        </div>
    </div>
    <script src="/page.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.css">
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.1.0/dist/markdown-it.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it-mark@4.0.0/dist/markdown-it-mark.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css">
    <script>
        globalThis.require = () => {
            return katex
        }
        globalThis.module = {}
    </script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it-katex@2.0.3/index.min.js"></script>
    <script>
        globalThis.markdownitKaTeX = globalThis.module.exports
    </script>
    
    <script defer>
        //TODO: plugin api based on this thingymabob (so that plugins wont have to edit the functions)
        const chaosEvents = window.chaosEvents = new EventTarget();
        chaosEvents.loaded = false;
        chaosEvents.on = chaosEvents.addEventListener;
        chaosEvents.once = function (event, listener) {
            const actualListener = function (...e) {
                chaosEvents
                listener(...e);
                chaosEvents.removeEventListener(event, actualListener)
            };
            chaosEvents.addEventListener(event, actualListener);
        }
        chaosEvents.doWhenReady = function (func) {
            if (chaosEvents.loaded) {
                func()
            } else {
                chaosEvents.once('ready', () => {
                    func()
                })
            }
        }
        
    window.settings_template = {
        replace_text: true,
        detect_file_type: false,
        debug: true,
        upload_key: "",
        upload_service: "",
        enter_to_send: false, //TODO: implement this
        custom_post_themes: true,
    }
    if (localStorage.getItem("settings") == null) {
        localStorage.setItem("settings", JSON.stringify(settings_template))
    };
    </script>
    <script src="/helpers/functions.js"></script>
    <script src="/helpers/ws.js"></script>
    <script src="/helpers/notification.js"></script>
    <script src="/main.js?93000" defer></script>
    <script src="/butcanitrundoom.js"></script>
</body>
</html>